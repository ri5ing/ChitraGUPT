{
  "entities": {
    "UserProfile": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "UserProfile",
      "type": "object",
      "description": "Represents a user profile in the ChitraGupt application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the user profile."
        },
        "email": {
          "type": "string",
          "description": "User's email address.",
          "format": "email"
        },
        "role": {
          "type": "string",
          "description": "User's role (client, auditor, admin)."
        },
        "subscriptionPlan": {
          "type": "string",
          "description": "The user's current subscription plan."
        },
        "creditBalance": {
          "type": "number",
          "description": "The user's current credit balance."
        },
        "maxActiveContracts": {
          "type": "number",
          "description": "The maximum number of contracts an auditor can review concurrently."
        },
        "currentActiveContracts": {
          "type": "number",
          "description": "The current number of active contracts an auditor is reviewing."
        }
      },
      "required": [
        "id",
        "email",
        "role",
        "subscriptionPlan",
        "creditBalance"
      ]
    },
    "AuditorProfile": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "AuditorProfile",
      "type": "object",
      "description": "Represents the public-facing profile of an auditor.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the auditor (matches their UID)."
        },
        "displayName": {
          "type": "string",
          "description": "The auditor's display name."
        },
        "avatarUrl": {
          "type": "string",
          "description": "URL for the auditor's avatar image."
        },
        "firm": {
          "type": "string",
          "description": "The auditor's firm or if they are independent."
        },
        "specialization": {
          "type": "array",
          "description": "The auditor's areas of legal specialization.",
          "items": {
            "type": "string"
          }
        },
        "experience": {
          "type": "number",
          "description": "The auditor's years of experience."
        },
        "maxActiveContracts": {
          "type": "number",
          "description": "The maximum number of contracts an auditor can review concurrently."
        },
        "currentActiveContracts": {
          "type": "number",
          "description": "The current number of active contracts an auditor is reviewing."
        }
      },
      "required": ["id", "displayName", "avatarUrl"]
    },
    "Contract": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Contract",
      "type": "object",
      "description": "Represents a contract uploaded to the ChitraGupt application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the contract."
        },
        "userId": {
          "type": "string",
          "description": "Reference to UserProfile. (Relationship: UserProfile 1:N Contract)"
        },
        "uploadDate": {
          "type": "string",
          "description": "Date and time when the contract was uploaded.",
          "format": "date-time"
        },
        "documentName": {
          "type": "string",
          "description": "The file name of the uploaded contract."
        },
        "analysisReportId": {
          "type": "string",
          "description": "Reference to the AIAnalysisReport. (Relationship: Contract 1:1 AIAnalysisReport)"
        },
        "publicReportId": {
            "type": "string",
            "description": "Reference to the PublicContractReport. (Relationship: Contract 1:1 PublicContractReport)"
        },
        "finalFeedback": {
            "$ref": "#/backend/entities/AuditorFeedback"
        }
      },
      "required": [
        "id",
        "userId",
        "uploadDate",
        "documentName",
        "analysisReportId"
      ]
    },
    "AIAnalysisReport": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "AIAnalysisReport",
      "type": "object",
      "description": "Represents the AI analysis report generated for a contract.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the AI analysis report."
        },
        "summary": {
          "type": "string",
          "description": "Summary of the contract generated by AI."
        },
        "riskScore": {
          "type": "number",
          "description": "Risk score of the contract generated by AI."
        },
        "missingClauses": {
          "type": "array",
          "description": "List of missing clauses identified by AI.",
          "items": {
            "type": "string"
          }
        },
        "recommendations": {
          "type": "string",
          "description": "Recommendations generated by AI."
        }
      },
      "required": [
        "id",
        "summary",
        "riskScore",
        "missingClauses",
        "recommendations"
      ]
    },
    "PublicContractReport": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "PublicContractReport",
      "type": "object",
      "description": "A publicly accessible, read-only version of a contract analysis report.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique, unguessable identifier for the public report."
        },
        "contractTitle": {
          "type": "string",
          "description": "The title of the original contract."
        },
        "uploadDate": {
          "type": "string",
          "format": "date-time",
          "description": "The original upload date of the contract."
        },
        "analysis": {
          "$ref": "#/backend/entities/AIAnalysisReport"
        }
      },
      "required": ["id", "contractTitle", "uploadDate", "analysis"]
    },
    "ReviewRequest": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ReviewRequest",
      "type": "object",
      "description": "Represents a request for an auditor to review a contract.",
      "properties": {
        "id": { "type": "string", "description": "Unique ID for the review request." },
        "contractId": { "type": "string", "description": "ID of the original contract." },
        "contractTitle": { "type": "string", "description": "Title of the contract." },
        "clientId": { "type": "string", "description": "UID of the client who made the request." },
        "clientName": { "type": "string", "description": "Display name of the client." },
        "auditorId": { "type": "string", "description": "UID of the assigned auditor." },
        "status": { "type": "string", "description": "Status of the review (pending, accepted, rejected).", "enum": ["pending", "accepted", "rejected"] },
        "requestDate": { "type": "string", "format": "date-time", "description": "Timestamp when the request was made." }
      },
      "required": ["id", "contractId", "contractTitle", "clientId", "clientName", "auditorId", "status", "requestDate"]
    },
    "AuditorFeedback": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "AuditorFeedback",
      "type": "object",
      "description": "Represents final feedback provided by an auditor on a contract after review.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the auditor feedback."
        },
        "contractId": {
          "type": "string",
          "description": "Reference to the reviewed contract."
        },
        "auditorId": {
          "type": "string",
          "description": "Reference to the auditor who provided the feedback."
        },
        "auditorName": {
            "type": "string",
            "description": "Display name of the auditor at the time of feedback."
        },
        "auditorAvatarUrl": {
            "type": "string",
            "description": "URL of the auditor's avatar at the time of feedback."
        },
        "feedback": {
          "type": "string",
          "description": "The detailed textual feedback from the auditor."
        },
        "verdict": {
          "type": "string",
          "description": "The final verdict on the contract.",
          "enum": ["Approved", "Approved with Revisions", "Action Required"]
        },
        "timestamp": {
          "type": "string",
          "format": "date-time",
          "description": "The time the feedback was submitted."
        }
      },
      "required": [
        "id",
        "contractId",
        "auditorId",
        "auditorName",
        "feedback",
        "verdict",
        "timestamp"
      ]
    },
    "Annotation": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Annotation",
      "type": "object",
      "description": "Represents annotations on a contract by an auditor.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the annotation."
        },
        "contractId": {
          "type": "string",
          "description": "Reference to Contract. (Relationship: Contract 1:N Annotation)"
        },
        "auditorId": {
          "type": "string",
          "description": "Reference to UserProfile (Auditor). (Relationship: UserProfile 1:N Annotation)"
        },
        "text": {
          "type": "string",
          "description": "The content of annotation."
        },
        "position": {
          "type": "string",
          "description": "The position of annotation in contract."
        }
      },
      "required": [
        "id",
        "contractId",
        "auditorId",
        "text",
        "position"
      ]
    },
    "ChatMessage": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ChatMessage",
      "type": "object",
      "description": "Represents a single message in a chat thread.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the message."
        },
        "senderId": {
          "type": "string",
          "description": "The UID of the user who sent the message."
        },
        "text": {
          "type": "string",
          "description": "The content of the message."
        },
        "timestamp": {
          "type": "string",
          "format": "date-time",
          "description": "The time the message was sent."
        }
      },
      "required": ["id", "senderId", "text", "timestamp"]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "/users/{userId}": {
      "schema": {
        "$ref": "#/backend/entities/UserProfile"
      },
      "description": "Stores user profile information. The userId is the Firebase Auth UID. This path enables path-based ownership for security rules."
    },
    "/auditors/{auditorId}": {
      "schema": {
        "$ref": "#/backend/entities/AuditorProfile"
      },
      "description": "Stores public-facing auditor profiles. This collection can be read by any authenticated user, which is required for the 'Recommend Auditor' feature. Writes are restricted to the auditor or an admin."
    },
    "/users/{userId}/contracts/{contractId}": {
      "schema": {
        "$ref": "#/backend/entities/Contract"
      },
      "description": "Stores contracts uploaded by users. The userId parameter ensures that only the owner can access the contract (path-based ownership)."
    },
    "/publicReports/{reportId}": {
      "schema": {
        "$ref": "#/backend/entities/PublicContractReport"
      },
      "description": "Stores read-only copies of contract analysis reports for sharing via a public link. This collection is readable by anyone but writeable only by server-side logic."
    },
    "/reviewRequests/{requestId}": {
      "schema": {
        "$ref": "#/backend/entities/ReviewRequest"
      },
      "description": "Stores contract review requests sent to auditors. This collection can be read by the assigned auditor and the client who created the request. Writes are restricted."
    },
    "/users/{userId}/contracts/{contractId}/analysisReports/{analysisReportId}": {
      "schema": {
        "$ref": "#/backend/entities/AIAnalysisReport"
      },
      "description": "Stores AI analysis reports for each contract. The structure maintains a clear hierarchy and ensures path-based ownership."
    },
    "/users/{userId}/contracts/{contractId}/auditorFeedback/{auditorFeedbackId}": {
      "schema": {
        "$ref": "#/backend/entities/AuditorFeedback"
      },
      "description": "Stores final auditor feedback for a contract. The structure maintains a clear hierarchy and ensures that only the assigned auditor can add feedback."
    },
    "/users/{userId}/contracts/{contractId}/annotations/{annotationId}": {
      "schema": {
        "$ref": "#/backend/entities/Annotation"
      },
      "description": "Stores annotations made by auditors on specific contracts.  The structure ensures that annotations are directly linked to a contract and an auditor."
    },
    "/users/{userId}/contracts/{contractId}/chats/{messageId}": {
      "schema": {
        "$ref": "#/backend/entities/ChatMessage"
      },
      "description": "Stores chat messages for a specific contract review between a client and an auditor."
    }
  }
}
